01. SELECT TITLE FROM MOVIE WHERE DIRECTOR = 'STEVEN SPIELBERG';

02. SELECT M.TITLE,M.YEAR FROM MOVIE M INNER JOIN RATING R ON M.M_ID = R.M_ID WHERE R.STARS IN (4,5) ORDER BY M.YEAR;

03. SELECT M.TITLE FROM MOVIE M INNER JOIN RATING R ON M.M_ID = R.M_ID WHERE R.STARS IS NULL;

04. SELECT RV.NAME FROM REVIEWER RV INNER JOIN RATING RA ON RV.R_ID = RA.R_ID WHERE RATING_DATE IS NULL;

05. SELECT RV.NAME,M.TITLE,RA.STARS,RA.RATING_DATE FROM RATING RA INNER JOIN REVIEWER RV ON RA.R_ID = RV.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID ORDER BY RV.NAME,M.TITLE,RA.STARS;

06. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME,RANK() OVER (partition by M.TITLE order by AVG(RA.STARS)) AS PRORITY
    FROM REVIEWER RE INNER JOIN RATING RA ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY MOVIE_NAME;

07. SELECT M.TITLE,RA.STARS FROM RATING RA INNER JOIN MOVIE M ON RA.M_ID = M.M_ID WHERE RA.STARS IN (SELECT MAX(STARS) FROM RATING) ORDER BY M.TITLE;

08. SELECT M.TITLE,AVG(RA.STARS) OVERALL_RATING FROM RATING RA INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY M.TITLE ORDER BY RA.STARS DESC, M.TITLE;

09. SELECT AVG(OVERALL_RATING) OVERALL_RATING_BEFORE_1980 FROM (SELECT AVG(RA.STARS) OVERALL_RATING FROM MOVIE M INNER JOIN RATING RA
    ON M.M_ID = RA.M_ID WHERE M.TITLE IN (SELECT TITLE FROM MOVIE WHERE YEAR < 1980) GROUP BY M.TITLE) AS DERIVED_TABLE1;
    SELECT AVG(OVERALL_RATING) OVERALL_RATING_AFTER_1980 FROM
    (SELECT AVG(RA.STARS) OVERALL_RATING FROM MOVIE M INNER JOIN RATING RA 
    ON M.M_ID = RA.M_ID WHERE M.TITLE IN (SELECT TITLE FROM MOVIE WHERE YEAR > 1980) GROUP BY M.TITLE) AS DERIVED_TABLE2;

10. SELECT RE.NAME FROM REVIEWER RE INNER JOIN RATING RA ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON M.M_ID = RA.M_ID
    WHERE M.TITLE = 'Gone With the Wind';

11. SELECT RE.NAME,M.TITLE,RA.STARS FROM REVIEWER RE INNER JOIN RATING RA ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON M.M_ID = RA.M_ID
    WHERE RE.NAME IN (SELECT DIRECTOR FROM MOVIE);

12. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME FROM REVIEWER RE INNER JOIN RATING RA 
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY M.TITLE ORDER BY RE.NAME,M.TITLE;

13. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME FROM REVIEWER RE INNER JOIN RATING RA 
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID WHERE RE.NAME != 'CHRIS JACKSON' GROUP BY M.TITLE;

14. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME FROM REVIEWER RE INNER JOIN RATING RA 
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY RE.NAME ORDER BY RE.NAME;

15. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME,RA.STARS FROM REVIEWER RE INNER JOIN RATING RA
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID WHERE RA.STARS IN (SELECT MIN(STARS) FROM RATING);

16. SELECT RE.NAME REVIEWER_NAME,M.TITLE MOVIE_NAME,AVG(RA.STARS) FROM REVIEWER RE INNER JOIN RATING RA
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY M.TITLE ORDER BY RA.STARS DESC,M.TITLE;

18. SELECT DIRECTOR,TITLE MOVIE_NAME FROM (SELECT DIRECTOR,TITLE,COUNT(DIRECTOR) AS DIR_COUNT 
    FROM MOVIE GROUP BY DIRECTOR) AS NAMES WHERE DIR_COUNT >1;

19. SELECT MOVIE_NAME,AVG_RATING FROM (SELECT M.TITLE MOVIE_NAME,AVG(RA.STARS) AVG_RATING FROM REVIEWER RE INNER JOIN
    RATING RA ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY M.TITLE 
    ORDER BY AVG_RATING DESC LIMIT 2) AS AVG_DATA ;

20. SELECT MOVIE_NAME,AVG_RATING FROM (SELECT M.TITLE MOVIE_NAME,AVG(RA.STARS) AVG_RATING FROM REVIEWER RE INNER JOIN RATING RA
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID GROUP BY M.TITLE ORDER BY AVG_RATING LIMIT 2) AS AVG_DATA ;

21. SELECT M.DIRECTOR,M.TITLE MOVIE_NAME,RA.STARS FROM REVIEWER RE INNER JOIN RATING RA
    ON RE.R_ID = RA.R_ID INNER JOIN MOVIE M ON RA.M_ID = M.M_ID WHERE DIRECTOR IS NOT NULL GROUP BY MOVIE_NAME;
